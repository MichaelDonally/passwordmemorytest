 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
            <title>Login Page</title>
        </head>
        
        <body>
            <div id="passwordmemory">
                <font size="40"><label id="passworddisplayone"></label></font><br>
                <font size="40"><label id="passworddisplaytwo"></label></font><br>
                <font size="40"><label id="passworddisplaythree"></label></font><br>
            </div>
           
            <div id="login" style="display: none;"> 
                <font size="40"><label id="passwordprompt"></label></font><br>
                <label for="password">Password:</label>
                <input type="password" id="password" name="password">
                <div id="lower">
                    <button onclick="submitPassword()">Next</button>
                </div>
            </div>
            <button id="togview" onclick="toggleView()">Ready</button>
            
        </body>
        
        <script>
            var EMAIL_ID = 0, BANK_ID = 1, FB_ID = 2;
            var startMemory, endMemory, startEnter;
            var user, password = [], order = [EMAIL_ID,BANK_ID,FB_ID], numEntered = 0;
        
            function toggleView() {
                endMemory = startEnter = new Date();
                console.log('user: '+user+' - password: '+password);
                $('#passwordmemory').hide();
                $('#login').show();
                $('#togview').hide();
                
                var text = getTextForPrompt(order[0]);
                $('#passwordprompt').text(text);
            }
            
            function submitPassword() {
                var entered = $('#password').val();
                $('#password').val('');
                
                console.log(entered);
                var req = {
                    user: user,
                    memduration: endMemory.getTime()-startMemory.getTime(),
                    inputduration:(new Date()).getTime()-startEnter.getTime(),
                    status: ''+((entered==password[order[numEntered]]) ? 'success' : 'fail'),
                    entered: entered,
                    pass: password[order[numEntered]],
                    account: getTextForPrompt(order[numEntered]),
                    order: numEntered
                }
                
                $.post('loginattempt', req, function(data) {
                    console.log(data);
                });
                
                numEntered++;
                
                if (numEntered < 3) {
                    var text = getTextForPrompt(order[numEntered]);
                    $('#passwordprompt').text(text);
                    startEnter = new Date();
                }
                else { 
                    resetPage();
                }
            }
            
            $(document).ready(function() {
                resetPage();                
            });
            
            function getTextForPrompt(i) {
                switch(i) {
                    case EMAIL_ID:
                        return 'Email';
                    case BANK_ID:
                        return 'Bank';
                        break;
                    case FB_ID:
                        return 'Facebook';
                    default:
                        return 'error in switch';
                }
            }
            
            function resetPage() {
                startMemory = new Date();
                
                $.get('getpassword', function(data) {
                    user = data.userId;
                    password = data.password;
                    $('#passworddisplayone').text('Email: '+password[EMAIL_ID]);
                    $('#passworddisplaytwo').text('Bank: '+password[BANK_ID]);
                    $('#passworddisplaythree').text('Facebook: '+password[FB_ID]);
                    
                    $('#passwordmemory').show();
                    $('#login').hide();
                    $('#togview').show();
                });
                
                var randA, randB, save;
                
                for (var i=0; i<5; i++) {    //Make 5 permutations of the order
                    randA = Math.floor(Math.random()*3);
                    while(randA == (randB = Math.floor(Math.random()*3)));
                    
                    save = order[randA];
                    order[randA] = order[randB];
                    order[randB] = save;
                }
            }
        </script>
        
    </html>